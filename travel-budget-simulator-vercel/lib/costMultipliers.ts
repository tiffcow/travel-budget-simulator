export type CountryKey = 'Portugal'|'Italy'|'France'|'UK'|'Spain'|'Vietnam';
export const defaultMultipliers: Record<CountryKey, number> = { Portugal:0.9, Italy:1.05, France:1.15, UK:1.3, Spain:0.95, Vietnam:0.6 };
export const teleportCitySlug: Record<CountryKey,string> = { Portugal:'lisbon', Italy:'rome', France:'paris', UK:'london', Spain:'barcelona', Vietnam:'ho-chi-minh-city' };
export async function fetchTeleportMultiplier(country: CountryKey): Promise<number|null>{ try{ const slug=teleportCitySlug[country]; const res=await fetch(`https://api.teleport.org/api/urban_areas/slug:${slug}/details/`, {cache:'no-store'}); if(!res.ok) return null; const data=await res.json(); const costs=data?.categories?.find((c:any)=>c.id==='COST-OF-LIVING'); if(!costs) return null; const items=costs.data?.filter((d:any)=>typeof d.currency_dollar_value==='number'); if(!items?.length) return null; const avg=items.reduce((s:number,d:any)=>s+(d.currency_dollar_value??0),0)/items.length; let lisbon=avg; if(country!=='Portugal'){ const lr=await fetch('https://api.teleport.org/api/urban_areas/slug:lisbon/details/', {cache:'no-store'}); if(!lr.ok) return null; const ld=await lr.json(); const lc=ld?.categories?.find((c:any)=>c.id==='COST-OF-LIVING'); const li=lc?.data?.filter((d:any)=>typeof d.currency_dollar_value==='number')??[]; lisbon=li.reduce((s:number,d:any)=>s+(d.currency_dollar_value??0),0)/(li.length||1) } if(!lisbon) return null; return avg/lisbon }catch{return null} }
